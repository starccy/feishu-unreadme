# feishu-unreadme


在 js 端屏蔽飞书消息的已读回执。即，自己在看到其他人发送的（私聊或群聊）普通消息后，
对方的视角也会保持在自己未读的状态。


## 使用方法

终端下执行：

```bash
python main.py <飞书安装根目录>
```

根据输出提示，脚本可能会修改若干个 js 文件，并创建同名的 `.bak` 备份文件。

修改成功后请重启飞书客户端。若发现飞书功能异常，请将脚本生成的 `.bak` 文件后缀
修改并替换回对应的 js 文件。


## 原理

飞书客户端前端 js 会监听 DOM 事件并尝试收集新消息的 messageId, 之后传给
native 层发送网络请求给服务器。所以在传给 native 之前把要传的消息列表 id
清空就好了。


## 已知问题 / TODO

毕竟只是在 js 层修改的逻辑，而非拦截网络请求等更加靠谱的方式。前端可能有多个入口
来进行消息已读回执的请求，导致在以下情况下对方会看到自己已读：

* 对一个消息进行引用并回复
* 对一个消息贴表情
* 接收对方发送的文件

以上是本人自己玩的时候遇到的问题，可能还存在其他情况。以上问题有时间慢慢解决。

此外要注意，飞书更新后会替换新的 js 文件，所以会导致修改失效。需要重新执行脚本来修改。